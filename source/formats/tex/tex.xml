<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE fileformat>
<fileformat>

	<xi:include href="../ovl_base/ovl_base.xml" xmlns:xi="http://www.w3.org/2001/XInclude" xpointer="xpointer(*/*)" />

	<enum name="DdsType" storage="ubyte">
		maps the OVL's dds type to name of compression format
<!--<option value="0" name="UNKNOWN" />-->
<!--<option value="1" name="R32G32B32A32F" />-->
<!--<option value="2" name="R32G32B32A32U" />-->
<!--<option value="3" name="R32G32B32A32S" />-->
<!--<option value="4" name="R32G32B32A32UN" />-->
<!--<option value="5" name="R32G32B32A32SN" />-->
<!--<option value="6" name="R32G32B32F" />-->
<!--<option value="7" name="R32G32B32U" />-->
<!--<option value="8" name="R32G32B32S" />-->
<!--<option value="9" name="R32G32B32UN" />-->
<!--<option value="10" name="R32G32B32SN" />-->
<!--<option value="11" name="R32G32F" />-->
<!--<option value="12" name="R32G32U" />-->
<!--<option value="13" name="R32G32S" />-->
<!--<option value="14" name="R32G32UN" />-->
<!--<option value="15" name="R32G32SN" />-->
<!--<option value="16" name="R32F" />-->
<!--<option value="17" name="R32U" />-->
<!--<option value="18" name="R32S" />-->
<!--<option value="19" name="R32UN" />-->
<!--<option value="20" name="R32SN" />-->
<!--<option value="21" name="R11G11B10F" />-->
<!--<option value="22" name="R11G11B10U" />-->
<!--<option value="23" name="R11G11B10S" />-->
<!--<option value="24" name="R11G11B10UN" />-->
<!--<option value="25" name="R11G11B10SN" />-->
<!--<option value="26" name="R10G10B10FA2UN" />-->
<!--<option value="27" name="R10G10B10A2U" />-->
<!--<option value="28" name="R10G10B10A2UN" />-->
<!--<option value="29" name="R10G10B10X2U" />-->
<!--<option value="30" name="R10G10B10X2S" />-->
<!--<option value="31" name="R10G10B10X2UN" />-->
<!--<option value="32" name="R10G10B10X2SN" />-->
<!--<option value="33" name="R8G8B8A8U" />-->
<!--<option value="34" name="R8G8B8A8S" />-->
<!--<option value="35" name="R8G8B8A8UN" />-->
<!--<option value="36" name="R8G8B8A8SN" />-->
<!--<option value="37" name="R8G8B8A8UN_SRGB" />-->
<!--<option value="38" name="R16G16B16A16F" />-->
<!--<option value="39" name="R16G16B16A16U" />-->
<!--<option value="40" name="R16G16B16A16S" />-->
<!--<option value="41" name="R16G16B16A16UN" />-->
<!--<option value="42" name="R16G16B16A16SN" />-->
<!--<option value="43" name="R16G16F" />-->
<!--<option value="44" name="R16G16U" />-->
<!--<option value="45" name="R16G16S" />-->
<!--<option value="46" name="R16G16UN" />-->
<!--<option value="47" name="R16G16SN" />-->
<!--<option value="48" name="R16F" />-->
<!--<option value="49" name="R16U" />-->
<!--<option value="50" name="R16S" />-->
<!--<option value="51" name="R16UN" />-->
<!--<option value="52" name="R16SN" />-->
<!--<option value="53" name="R8G8U" />-->
<!--<option value="54" name="R8G8S" />-->
<!--<option value="55" name="R8G8UN" />-->
<!--<option value="56" name="R8G8SN" />-->
<!--<option value="57" name="R8U" />-->
<!--<option value="58" name="R8S" />-->
<!--<option value="59" name="R8UN" />-->
<!--<option value="60" name="R8SN" />-->
<!--<option value="61" name="B10G10R10A2UN" />-->
<!--<option value="62" name="B10G10R10X2UN" />-->
<!--<option value="63" name="B8G8R8A8UN" />-->
<!--<option value="64" name="B8G8R8A8UN_SRGB" />-->
<!--<option value="65" name="B8G8R8X8UN" />-->
<!--<option value="66" name="B8G8UN" />-->
<!--<option value="67" name="B8UN" />-->
<!--<option value="68" name="D32FS8U" />-->
<!--<option value="69" name="D32UN" />-->
<!--<option value="70" name="D32F" />-->
<!--<option value="71" name="D24UNS8U" />-->
<!--<option value="72" name="D24FS8U" />-->
<!--<option value="73" name="D24UNX8" />-->
<!--<option value="74" name="D24FX8" />-->
<!--<option value="75" name="D16UN" />-->
<!--<option value="76" name="D16F" />-->
<!--<option value="77" name="A8UN" />-->
<!--<option value="78" name="BC1" />-->
<!--<option value="79" name="BC1_SRGB" />-->
<!--<option value="80" name="BC2" />-->
<!--<option value="81" name="BC2_SRGB" />-->
<!--<option value="82" name="BC3" />-->
<!--<option value="83" name="BC3_SRGB" />-->
<!--<option value="84" name="BC4_UNORM" />-->
<!--<option value="85" name="BC4_SNORM" />-->
<!--<option value="86" name="BC5_UNORM" />-->
<!--<option value="87" name="BC5_SNORM" />-->
<!--<option value="88" name="BC6H_UF16" />-->
<!--<option value="89" name="BC6H_SF16" />-->
<!--<option value="90" name="BC7" />-->
<!--<option value="91" name="BC7_SRGB" />-->
<!--<option value="92" name="FMASK_R8U" />-->
<!--<option value="93" name="FMASK_R16U" />-->
<!--<option value="94" name="FMASK_R32U" />-->
<!--<option value="95" name="FMASK_R32G32U" />-->
<!--<option value="96" name="X32TG8UX24T" />-->
<!--<option value="97" name="X24TG8U" />-->

		<option value="16" name="UNK16">seemingly in JWE2 main</option>
		<option value="35" name="R8G8B8A8_UNORM"></option>
		<option value="37" name="R8G8B8A8_UNORM_SRGB">gharial_male.pclut.dds, or D24_UNORM_S8_UINT, R8G8B8A8_UNORM</option>
		<option value="38" name="D32_FLOAT_S8X24_UINT">atmospherics_stars_data.dds</option>
		<option value="43" name="R16G16_FLOAT"></option>
		<option value="59" name="UNK59">seemingly in JWE2 main</option>

		<option value="78" name="BC1_UNORM"></option>
		<option value="79" name="BC1_UNORM_SRGB"></option>
		<option value="80" name="BC2_UNORM"></option>
		<option value="81" name="BC2_UNORM_SRGB"></option>
		<option value="82" name="BC3_UNORM">PZ wolf baldnessscars texture</option>
		<option value="83" name="BC3_UNORM_SRGB"></option>
		<option value="84" name="BC4_UNORM"></option>
		<option value="85" name="BC4_SNORM"></option>
		<option value="86" name="BC5_UNORM"></option>
		<option value="87" name="BC5_SNORM"></option>
		<option value="88" name="BC6H_UF16">ptero aviary</option>
		<option value="89" name="BC6H_SF16"></option>
		<option value="90" name="BC7_UNORM"></option>
		<option value="91" name="BC7_UNORM_SRGB">PZ titan beetle</option>
    </enum>

    <enum name="DdsTypeCoaster" storage="ubyte">
		maps the OVL's dds type to name of compression format
		<option value="74" name="D24_UNORM_S8_UINT">ZTUAC ele heights textures</option>
		<option value="97" name="BC1_UNORM"></option>
		<option value="98" name="BC1_UNORM_SRGB"></option>
		<option value="99" name="BC2_UNORM"></option>
		<option value="100" name="BC2_UNORM_SRGB"></option>
		<option value="101" name="BC3_UNORM"></option>
		<option value="102" name="BC3_UNORM_SRGB"></option>
		<option value="103" name="BC4_UNORM"></option>
		<option value="104" name="BC4_SNORM"></option>
		<option value="105" name="BC5_UNORM"></option>
		<option value="106" name="BC5_SNORM"></option>

		<option value="121" name="BC4_UNORM_B"></option>
		<option value="126" name="BC7_UNORM"></option>
		<option value="127" name="BC7_UNORM_SRGB"></option>

		<option value="250" name="ALL"></option>
    </enum>

	<compound name="TexBuffer" >
		Part of a fragment, repeated for count of texture LODs / buffers.
		Data struct for headers of type 3
		24 bytes per texture buffer
		<add name="offset" type="uint64">byte offset in the combined buffer</add>
		<add name="size" type="uint64">byte size of this tex buffer</add>
		<add name="unkn" type="uint64">is also related to data size</add>
    </compound>

	<compound name="TexBufferPc" >
		<add name="width" type="ushort"/>
		<add name="height" type="ushort"/>
		<add name="array size" type="ushort" vercond="!#ZTUAC#">may be depth</add>
		<add name="mip index" type="ushort">max mip in this buffer</add>
    </compound>

	<compound name="SizeInfo" >
		Data struct for headers of type 7
		<add name="zero" type="uint64">zero</add>
		<add name="data size" type="uint" >total dds buffer size</add>
		<add name="width" type="uint">x size in pixels</add>
		<add name="height" type="uint" >y size in pixels</add>
		<add name="depth" type="uint" >may be depth</add>
		<add name="array_size" type="uint">amount of repeats of the data for each lod</add>
		<add name="num mips" type="uint">amount of mip map levels</add>
		<add name="unk_pz" type="uint64" since="20">only found in PZ and JWE2</add>
		<add name="mip maps" type="Mipmap" arr1="num mips">info about mip levels</add>
    </compound>

	<compound name="Mipmap" >
		Data struct for one mipmap, part of a data 1 struct in headers of type 7
		<add name="offset" type="uint">starting offset into the texture buffer for this mip level</add>
		<add name="size" type="uint" >bytes for one array entry</add>
		<add name="size array" type="uint">bytes for all array entries</add>
		<add name="size scan" type="uint" >size of a scan line of blocks, including padding that is added to the end of the line</add>
		<add name="size data" type="uint">size of the non-empty scanline blocks, ie. the last lods add empty scanlines as this is smaller than size</add>
    </compound>

    <compound name="TexHeader" inherit="MemStruct">
		DLA: 24 bytes, no pointers
        ZTUAC, PC: 24 bytes, with 1 pointer
        JWE, PZ, JWE2: 40 bytes, with 2 pointers
		<add name="zero 0" type="uint" until="15"/>
		<add name="zero 0" type="uint64" since="17"/>
		<add name="zero 1" type="uint64" since="19"/>

		<add name="buffer_infos" type="ArrayPointer" since="17" until="18" template="TexBufferPc" arg="stream_count"/>
		<add name="buffer_infos" type="ArrayPointer" since="19" template="TexBuffer" arg="stream_count"/>
		<add name="size_info" type="Pointer" since="19" template="SizeInfo"/>

		compression types do not index directly into the official DDS enum
		<add name="compression type" type="DdsType_Coaster" vercond="#OLD#"/>
		<add name="compression type" type="DdsType" vercond="!#OLD#"/>
		<add name="one 0" type="ubyte">0 or 1</add>
		<add name="num mips" type="ushort" until="15"/>
		<add name="width" type="ushort" until="15"/>
		<add name="height" type="ushort" until="15"/>
		<add name="stream_count" type="ubyte" since="17">amount of files combined in this texture, usually 1 or 2, 3 for JWE2 rex</add>
		<add name="stream_count repeat" type="ubyte" since="17">usually as above</add>
		<add name="pad" type="uint">0</add>
		<add name="pad dla" type="uint64" until="15"/>
    </compound>

    <compound name="TexInfoHeader" inherit="GenericHeader">
		<add name="tex info" type="TexHeader"/>
		<add name="frag_01" type="TexBufferPc" arr1="tex info \ stream_count" since="17" until="18"/>
		<add name="frag_01" type="TexBuffer" arr1="tex info \ stream_count" since="19"/>
		<add name="frag_11" type="SizeInfo" since="19"/>
		<add name="padding" type="ubyte" arr1="320 - (frag_11 \ io_size)" vercond="#PZ16# #OR# #PZ# #OR# #JWE2#">pad whole frag_11 struct to 320 bytes</add>
		<add name="padding" type="ubyte" arr1="384 - (frag_11 \ io_size)" vercond="#JWE#">pad whole frag_11 struct to 320 bytes</add>
    </compound>
</fileformat>

