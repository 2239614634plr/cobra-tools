<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE niftoolsxml>
<niftoolsxml version="0.7.1.0">

	<xi:include href="../ovl_base/ovl_base.xml" xmlns:xi="http://www.w3.org/2001/XInclude" xpointer="xpointer(*/*)" />

    <enum name="SpecdefDtype" numbytes="4" storage="uint" default="0">
		<option value="0" name="Boolean" />
		<option value="1" name="Int8" />
		<option value="2" name="Int16" />
		<option value="3" name="Int32" />
		<option value="4" name="Int64" />
		<option value="5" name="UInt8" />
		<option value="6" name="UInt16" />
		<option value="7" name="UInt32" />
		<option value="8" name="UInt64" />
		<option value="9" name="Float" />
		<option value="10" name="String" />
		<option value="11" name="Vector2" />
		<option value="12" name="Vector3" />
		<option value="13" name="Array" />
		<option value="14" name="ChildItem" />
		<option value="15" name="ReferenceToObject" />
    </enum>

    <compound name="SpecdefRoot" inherit="MemStruct">
        <add name="attrib_count" type="ushort" />
        <add name="flags" type="ushort" />
        <add name="name_count" type="ubyte" />
        <add name="childspec_count" type="ubyte" />
        <add name="manager_count" type="ubyte" />
        <add name="script_count" type="ubyte" />
        <add name="attrib_dtypes" type="ArrayPointer" template="SpecdefDtype" arg="attrib_count"/>
        <add name="attrib_names" type="Pointer" template="PtrList" arg="attrib_count"/>
        <add name="attrib_datas" type="ForEachPointer" template="DataPtr" arg="attrib_dtypes"/>

        <add name="names" type="Pointer" template="PtrList" arg="name_count"/>
        <add name="childspecs" type="Pointer" template="PtrList" arg="childspec_count"/>
        <add name="managers" type="Pointer" template="PtrList" arg="manager_count"/>
        <add name="scripts" type="Pointer" template="PtrList" arg="script_count"/>
    </compound>

    <compound name="PtrList" inherit="MemStruct">
        <add name="ptrs" type="Pointer" template="ZString" arr1="#ARG#"/>
    </compound>

    <compound name="DataPtr" inherit="MemStruct">
        #ARG# is dtype
        <add name="ptr" type="Pointer" template="Data" arg="#ARG#"/>
    </compound>

    <compound name="Data" inherit="MemStruct">
        #ARG# is dtype
        <add name="dtype" type="BooleanData" cond="#ARG# #EQ# 0"/>
        <add name="dtype" type="Uint8Data" cond="#ARG# #EQ# 5"/>
        <add name="dtype" type="FloatData" cond="#ARG# #EQ# 9"/>
        <add name="dtype" type="StringData" cond="#ARG# #EQ# 10"/>
        <add name="dtype" type="Vector2" cond="#ARG# #EQ# 11"/>
        <add name="dtype" type="Vector3" cond="#ARG# #EQ# 12"/>
        <add name="dtype" type="ReferenceToObjectData" cond="#ARG# #EQ# 15"/>
    </compound>

    <compound name="BooleanData" inherit="MemStruct">
        8 bytes
        <add name="value" type="ubyte"/>
        <add name="default" type="ubyte"/>
        <add name="unused" type="ubyte" arr1="6"/>
    </compound>

    <compound name="Uint8Data" inherit="MemStruct">
        8 bytes
        <add name="imin" type="ubyte"/>
        <add name="imax" type="ubyte"/>
        <add name="ivalue" type="ubyte"/>
        <add name="ioptional" type="ubyte"/>
        <add name="unused" type="ubyte" arr1="4"/>
    </compound>

    <compound name="FloatData" inherit="MemStruct">
        16 bytes
        <add name="imin" type="float"/>
        <add name="imax" type="float"/>
        <add name="ivalue" type="float"/>
        <add name="ioptional" type="uint"/>
    </compound>

    <compound name="StringData" inherit="MemStruct">
        12 bytes ?
        <add name="str_name" type="Pointer" template="ZString" />
        <add name="ioptional" type="uint"/>
    </compound>

    <compound name="ReferenceToObjectData" inherit="MemStruct">
        12 bytes ?
        <add name="str_name" type="Pointer" template="ZString" />
        <add name="ioptional" type="uint"/>
    </compound>

    <compound name="Vector2" inherit="MemStruct">
        16 bytes
        <add name="x" type="float"/>
        <add name="y" type="float"/>
        <add name="ioptional" type="uint"/>
        <add name="unused" type="uint"/>
    </compound>

    <compound name="Vector3" inherit="MemStruct">
        16 bytes
        <add name="x" type="float"/>
        <add name="y" type="float"/>
        <add name="z" type="float"/>
        <add name="ioptional" type="uint"/>
    </compound>

</niftoolsxml>
